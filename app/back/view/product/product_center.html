<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta charset="utf-8" />
	<title>产品列表</title>
	<meta name="Keywords" content="关键词" />
	<meta name="description" content="overview &amp; stats" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

	<!-- bootstrap & fontawesome -->
	<link rel="stylesheet" href="__STATIC__/assets/css/bootstrap.min.css" />
	<link rel="stylesheet" href="__STATIC__/assets/font-awesome/4.5.0/css/font-awesome.min.css" />

	<!-- page specific plugin styles -->

	<!-- text fonts -->
	<!--<link rel="stylesheet" href="__STATIC__/assets/css/fonts.googleapis.com.css" />-->
	<link rel="stylesheet" href="__STATIC__/assets/css/bootstrap-datepicker3.min.css" />
	<link rel="stylesheet" href="__STATIC__/assets/css/daterangepicker.min.css" />

	<!-- ace styles -->
	<link rel="stylesheet" href="__STATIC__/assets/css/ace.min.css" class="ace-main-stylesheet" id="main-ace-style" />

	<!--[if lte IE 9]>
	<link rel="stylesheet" href="__STATIC__/assets/css/ace-part2.min.css" class="ace-main-stylesheet" />
	<![endif]-->
	<link rel="stylesheet" href="__STATIC__/assets/css/ace-skins.min.css" />
	<link rel="stylesheet" href="__STATIC__/assets/css/ace-rtl.min.css" />
	<link rel="stylesheet" href="__STATIC__/assets/css/myStyle.css" />

	<!--[if lte IE 9]>
	<link rel="stylesheet" href="__STATIC__/assets/css/ace-ie.min.css" />
	<![endif]-->

	<!-- inline styles related to this page -->

	<!-- ace settings handler -->
	<script src="__STATIC__/assets/js/ace-extra.min.js"></script>

	<!-- HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries -->

	<!--[if lte IE 8]>
	<script src="__STATIC__/assets/js/html5shiv.min.js"></script>
	<script src="__STATIC__/assets/js/respond.min.js"></script>
	<![endif]-->
</head>

<body class="no-skin">
<{include file="public:nav_top"}>

<div class="main-container ace-save-state" id="main-container">
	<script type="text/javascript">
		try {
			ace.settings.loadState('main-container')
		} catch(e) {}
	</script>

	<div id="sidebar" class="sidebar                  responsive                    ace-save-state">
		<script type="text/javascript">
			try {
				ace.settings.loadState('sidebar')
			} catch(e) {}
		</script>

		<div class="sidebar-shortcuts" id="sidebar-shortcuts">
			<div class="sidebar-shortcuts-large" id="sidebar-shortcuts-large">
				<a href="parameter.html" class="btn btn-success">
					<i class="ace-icon fa fa-desktop"></i>
				</a>

				<a href="add-content.html" class="btn btn-info">
					<i class="ace-icon fa fa-pencil"></i>
				</a>

				<a href="admin-list.html" class="btn btn-warning">
					<i class="ace-icon fa fa-users"></i>
				</a>

				<a href="ad.html" class="btn btn-danger">
					<i class="ace-icon fa fa-diamond"></i>
				</a>
			</div>

			<div class="sidebar-shortcuts-mini" id="sidebar-shortcuts-mini">
				<span class="btn btn-success"></span>

				<span class="btn btn-info"></span>

				<span class="btn btn-warning"></span>

				<span class="btn btn-danger"></span>
			</div>
		</div>
		<!-- /.sidebar-shortcuts -->

		<{include file="public:menu"}>
		<!-- /.nav-list -->

		<div class="sidebar-toggle sidebar-collapse" id="sidebar-collapse">
			<i id="sidebar-toggle-icon" class="ace-icon fa fa-angle-double-left ace-save-state" data-icon1="ace-icon fa fa-angle-double-left" data-icon2="ace-icon fa fa-angle-double-right"></i>
		</div>
	</div>

	<div class="main-content">
		<div class="main-content-inner">
			<div class="breadcrumbs ace-save-state" id="breadcrumbs">
				<ul class="breadcrumb">
					<li>
						<i class="ace-icon fa fa-home home-icon"></i>
						<a href="index.html">首页</a>
					</li>
					<li>
						<a href="#">内容管理</a>
					</li>
					<li class="active">产品列表</li>
				</ul>
				<!-- /.breadcrumb -->
				<div class="nav-search" id="nav-search">
					<form class="form-search">
								<span class="input-icon">
									<input type="text" placeholder="搜索 ..." class="nav-search-input" id="nav-search-input" autocomplete="off" />
									<i class="ace-icon fa fa-search nav-search-icon"></i>
								</span>
					</form>
				</div>
				<!-- /.nav-search -->
			</div>

			<div class="page-content">
				<!--设置按钮-->
				<!-- /.ace-settings-container -->

				<!-- /.page-header -->
				<div class="row">
					<form action="p_center.html" method="POST">
							<div class="col-xs-12 col-sm-4" style="width: 45%;">
								<a href="add_product.html" class="btn btn-success btn-sm"><i class="ace-icon fa fa-plus"></i>添加产品</a>
								&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
								<select name="pc_id" class="hidden-480">
									<option >商品分类</option>
									<{PRESENT name="pc_class"}>
										<{foreach name="pc_class" item="class"}>
											<option value="<{$class.pc_id}>">├├<{$class.pc_name}></option>
											<{PRESENT name="class['two']"}>
												<{foreach name="class['two']" item="two"}>
													<option value="<{$two.pc_id}>">├├├├<{$two.pc_name}></option>
													<{PRESENT name="two['three']"}>
														<{foreach name="two['three']" item="three"}>
															<option value="<{$three.pc_id}>">├├├├├├<{$three.pc_name}></option>
														<{/foreach}>
													<{/PRESENT}>
												<{/foreach}>
											<{/PRESENT}>
										<{/foreach}>
									<{/PRESENT}>
								</select>
								<!--<select name="brand_id" class="ajax_change hidden-480">
									<option value="">商品品牌</option>
									<{foreach name="brand_list" item="brand"}>
										<option value="<{$brand.brand_id}>"><{$brand.brand_name}></option>
									<{/foreach}>
								</select>-->

								<!--<select name="diyflag" class="ajax_change hidden-480">
									<option >供货商</option>
									<{foreach name="suppliers_list" item="supplier"}>
										<option value="<{$supplier.supplier_id}>"><{$supplier.supplier_name}></option>
									<{/foreach}>
								</select>-->

								<!--<select name="product_state" class="ajax_change hidden-480">
									<option value>全部</option>
									<option value="20">上架</option>
									<option value="30">下架</option>
								</select>-->
							</div>
							<div class="col-xs-12 col-sm-3 btn-sespan hidden-480">
								<div class="input-group" style="width: 400px;">
											<span class="input-group-addon">
												<i class="ace-icon fa fa-check"></i>
											</span>
									<input type="text" name="key" id="key" class="form-control search-query" value="" placeholder="输入需查询的关键字、商品名称">
									<span class="input-group-btn">
												<button type="submit" class="btn btn-info btn-sm ajax-search-form">
													<span class="ace-icon fa fa-search icon-on-right bigger-110"></span> 搜索
											</button>
											</span>
								</div>
							</div>
					</form>
				</div>

				<div class="space-4"></div>

				<div class="row">
					<button id="delAll" class="btn btn-white btn-danger btn-sm" data-type="del">删除</button>
					<button class="btn btn-white btn-success btn-sm btn_type" data-type="start">上架</button>
					<button class="btn btn-white btn-danger btn-sm btn_type" data-type="stop">下架</button>
					<!--<button class="btn btn-white btn-warning btn-sm btn_type" data-type="wx_code">更新二维码</button>-->
				</div>

				<div class="space-4"></div>

				<div class="row">
					<!--<form id="export-form" method="post" class="form-horizontal" action="">-->
					<table width="100%" class="table table-striped table-bordered table-hover" id="dynamic-table">
						<thead>
						<tr>
							<th width="6%">
								<label class="pos-rel">
									<input class="check-all ace" id="chkAll" type="checkbox" value="" />
									<span class="lbl"></span>
								</label>
							</th>
							<th>产品标题</th>
							<th>产品分类</th>
							<th  width="15%" class="hidden-480">价格</th>
							<!--<th  width="10%" class="hidden-480">库存</th>-->
							<th  width="10%" class="hidden-480">时间</th>
							<th  width="10%" class="hidden-480">上下架</th>
							<th style="border-right:#ddd solid 1px;">操作</th>
						</tr>
						</thead>
						<tbody>
						<{foreach name="plist" item="product"}>
								<tr>
									<td>
										<label class="pos-rel">
											<input class="ids ace" type="checkbox" name="tables[]" value="<{$product.product_id}>">
											<span class="lbl">&nbsp;&nbsp;&nbsp;<{$product.product_id}></span>
										</label>
									</td>

									<td>
										<a href="javascript:(0);" style="margin:5px;float: left;">
											<img class="media-object hidden-480" data-src="__PUBLIC__/<{$product.product_image}>" alt="<{$product.product_name}>" src="__PUBLIC__/<{$product.product_image}>" style="width: 72px; height: 72px;">
										</a>
										<h4 style="float: left;margin:5px;">
											商品名称:<span class="blue"><{$product.product_name}></span>
										</h4>


									</td>
									<td class="hidden-480"><{:return_columnName($product['pc_id'])}></td>
									<td class="hidden-480">
										价格：￥<{$product.product_market_price}>
										<!--销售价：￥<{$product.product_sale_price}><br/>
										会员价：￥<{$product.product_member_price}><br/>
										成本价：￥<{$product.product_base_price}>-->
									</td>
									<!--<td class="hidden-480"><{$product.product_account}></td>-->
									<td class="hidden-480"><{$product.product_start_time}></td>
									<td class="hidden-480">
										<{eq name="product['product_state']" value="20"}>
												<button class="status btn btn-minier btn-success" type="button" onClick="under('<{$product.product_id}>',20)">
													<i class="ace-icon fa fa-level-up"></i>
													已上架
												</button>
										<{/eq}>
										<{eq name="product['product_state']" value="30"}>
												<button class="status btn btn-minier btn-danger" type="button"  onClick="under('<{$product.product_id}>',10)">
													<i class="ace-icon fa fa-level-down"></i>
													已下架
												</button>
										<{/eq}>

									</td>
									<td>
										<a href="edit-product.html?param=<{$product.product_id}>" class="btn btn-xs btn-info" data-id="<{$product.product_id}>">
											<i class="ace-icon fa fa-pencil bigger-120"></i>
										</a>
										<button class="btn btn-xs btn-danger bootbox-del"  data-type="del" data-id="<{$product.product_id}>">
											<i class="ace-icon fa fa-trash-o bigger-120"></i>
										</button>
										<button class="btn btn-xs btn-warning bootbox-wx" data-type="wx_code" data-id="<{$product.product_id}>">
											<i class="ace-icon fa fa-qrcode bigger-120"></i>
										</button>
									</td>
								</tr>
						<{/foreach}>
						</tbody>
					</table>
					</form>
				</div>
				<!-- /.row -->
			</div>
			<{$page_info}>
			<!-- /.page-content -->
		</div>
	</div>
	<!-- /.main-content -->

	<{include file="public:footer"}>
</div>

<a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
	<i class="ace-icon fa fa-angle-double-up icon-only bigger-110"></i>
</a>
</div>
<!-- /.main-container -->

<!-- basic scripts -->

<!--[if !IE]> -->
<script src="__STATIC__/assets/js/jquery-2.1.4.min.js"></script>

<!-- <![endif]-->

<!--[if IE]>
<script src="__STATIC__/assets/js/jquery-1.11.3.min.js"></script>
<![endif]-->
<script type="text/javascript">
	if('ontouchstart' in document.documentElement) document.write("<script src='__STATIC__/assets/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
</script>
<script src="__STATIC__/assets/js/bootstrap.min.js"></script>

<!-- page specific plugin scripts -->

<!--[if lte IE 8]>
<script src="__STATIC__/assets/js/excanvas.min.js"></script>
<![endif]-->
<script src="__STATIC__/assets/js/jquery-ui.custom.min.js"></script>
<script src="__STATIC__/assets/js/jquery.ui.touch-punch.min.js"></script>
<script src="__STATIC__/assets/js/jquery.easypiechart.min.js"></script>
<script src="__STATIC__/assets/js/jquery.sparkline.index.min.js"></script>
<script src="__STATIC__/assets/js/jquery.flot.min.js"></script>
<script src="__STATIC__/assets/js/jquery.flot.pie.min.js"></script>
<script src="__STATIC__/assets/js/jquery.flot.resize.min.js"></script>
<!---->

<script src="__STATIC__/assets/js/bootstrap-datepicker.min.js"></script>
<script src="__STATIC__/assets/js/moment.min.js"></script>
<script src="__STATIC__/assets/js/daterangepicker.min.js"></script>

<!-- page specific plugin scripts -->
<script src="__STATIC__/assets/js/wizard.min.js"></script>
<script src="__STATIC__/assets/js/jquery-additional-methods.min.js"></script>
<script src="__STATIC__/assets/js/bootbox.js"></script>
<script src="__STATIC__/assets/js/jquery.maskedinput.min.js"></script>
<script src="__STATIC__/assets/js/select2.min.js"></script>
<!-- ace scripts -->
<script src="__STATIC__/assets/js/ace-elements.min.js"></script>
<script src="__STATIC__/assets/js/ace.min.js"></script>
<script src="__STATIC__/assets/js/main.js"></script>
<!-- inline scripts related to this page -->
<script type="text/javascript">

	jQuery(function($) {
		//删除按钮
		var alert_msg = "";
		$(".bootbox-del,#delAll,.btn_type,.bootbox-wx").on(ace.click_event, function() {
			var btn_type = $(this).attr("data-type");
			//选中按钮或者单个删除
			var attrData = $(this).attr('data-id');
			var check_list = [];
			if(attrData){
				//单个删除
				check_list.push(attrData);
			}else{
				//全部删除
				$("#dynamic-table input:checkbox").each(function(){
					var attr = $(this).prop("checked");
					var productId = $(this).val();
					if(attr===true && productId>0){
						//选中
						check_list.push(productId);
					}
				});
			}
			if(check_list.length <=0){
				alert("请选中要删除的商品");
				return false;
			}
			if(btn_type=="del"){
				alert_msg = "是否删除此产品到产品回收站？";
			}
			if(btn_type=="stop"){
				alert_msg = "是否要下架选中产品？";
			}
			if(btn_type=="start"){
				alert_msg = "是否要上架选中产品？";
			}
			if(btn_type=="wx_code"){
				alert_msg = "是否要更新选种产品二维码？";
			}
			bootbox.confirm({
				message: alert_msg,
				size: 'small',
				buttons: {
					confirm:{label:"确认操作"},
					cancel:{label:"取消操作"}
				},
				callback: function(result) {
					if(result) {
						//确定后执行
                        delProduct(check_list,btn_type);
					}
				}
			});
		});
		//排序按钮
		$("#sort").on(ace.click_event, function() {
			bootbox.alert({
				message: "已更新排序",
				size: 'small',
				callback: function(result) {
					if(result) {
						//确定后执行
					}
				}
			});
		});
		$('input[name=date-range-picker]').daterangepicker({
			'applyClass': 'btn-sm btn-success',
			'cancelClass': 'btn-sm btn-default',
			locale: {
				applyLabel: '确定',
				cancelLabel: '取消',
			}
		})
				.prev().on(ace.click_event, function() {
			$(this).next().focus();
		});
	});

	//商品删除
	function delProduct(data,type){
		if(!data){
			alert("参数错误");
			return false;
		}
		$.ajax({
			url:"del_product.html",
			type:"post",
			dataType:"json",
			data:{delId:data,type:type},
			success:function(result){
				alert(result.msg);
				if(result.code==200){
					window.location.href="p_center.html";
				}
			}
		});
	}
</script>
</body>
</html>